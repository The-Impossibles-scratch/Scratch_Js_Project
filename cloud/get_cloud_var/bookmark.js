javascript:(async()=>{function downloadJSON(data,filename){const blob=new Blob([JSON.stringify(data,null,2)],{type:"application/json"});const url=URL.createObjectURL(blob);const a=document.createElement("a");a.href=url;a.download=filename;a.click();URL.revokeObjectURL(url);}async function get_cloud_var(project_id,limit,offset,filter_by_name){const url=`https://clouddata.scratch.mit.edu/logs?projectid=${project_id}&limit=${limit}&offset=${offset}`;try{const fetch_response=await fetch(url);const cloud_logs=await fetch_response.json();if(cloud_logs.length==0){alert("There seems to be no Cloud Data activity on this project…");return [];}const filtered_cloud_logs=cloud_logs.filter(cloud=>cloud.name==`☁ ${filter_by_name}`);if(filtered_cloud_logs.length==0){alert("There seems to be no Cloud Data activity for the specified variable…");return [];}const latest_cloud_log=filtered_cloud_logs.reduce((prev,current)=>{return(prev.timestamp>current.timestamp)?prev:current;});const output={User:latest_cloud_log.user,Data_Name:latest_cloud_log.name,Action:latest_cloud_log.verb,Data_Value:latest_cloud_log.value,Time:new Date(latest_cloud_log.timestamp).toLocaleString()};alert(`User: ${output.User}\nData Name: ${output.Data_Name}\nAction: ${output.Action}\nData Value: ${output.Data_Value}\nTime: ${output.Time}`);downloadJSON(filtered_cloud_logs,`cloud_logs_${project_id}_${filter_by_name}.json`);return output;}catch(error){alert("Fetch Error : "+error);return [];}};var project_id=prompt("Input Project ID (If nothing is entered, it will automatically be the current Project Id.)");if(!project_id){const url=window.location.href;const projectId=url.match(/projects\/(\d+)/)?.[1];project_id=Number(projectId);}var filter_by_name=prompt("Input Cloud Var");if(!filter_by_name){alert("Please Input Cloud Var");return;}var limit=prompt("Input Limit (If nothing is entered, it will automatically be 100.)");if(!limit){limit=100}limit=Number(limit);var offset=prompt("Input Offset (If nothing is enterd, it will automatically be 0).");if(!offset){offset=0}offset=Number(offset);get_cloud_var(project_id,limit,offset,filter_by_name);})();
